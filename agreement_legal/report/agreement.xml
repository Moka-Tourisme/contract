<?xml version="1.0"?>
<odoo>

    <report
            id="partner_agreement_contract_document"
            model="agreement"
            string="Contract Document"
            name="agreement_legal.report_agreement_document"
            file="agreement_legal.report_agreement_document"
            report_type="qweb-pdf"/>

    <report
            id="partner_agreement_contract_document_preview"
            model="agreement"
            string="Contract Document Preview"
            name="agreement_legal.report_agreement_document"
            file="agreement_legal.report_agreement_document"
            report_type="qweb-html"/>

    <template id="report_agreement_document">
        <t t-name="agreement.report_agreement_document">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="web.external_layout">
                        <div class="page">
                          
                            <!-- Title and subtitle -->
                            
                            <h1 t-field="doc.name"/>
                            <div name="description">
                                <span t-field="doc.dynamic_description"/>
                            </div>
                            
                            <!-- Parties presentation -->
                            
                            <h2>Parties</h2>
                            <div name="parties">
                                <t t-if="doc.use_parties_content">
                                    <p t-field="doc.dynamic_parties"/>
                                </t>
                            </div>
                            <t t-if="not doc.use_parties_content">
                                <h3>Company Information</h3>
                                <div name="company_address">
                                    <address t-field="doc.company_id.partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;], &quot;no_marker&quot;: True}"/>
                                </div>
                                <div name="company_contact">
                                    Represented by <span t-field="doc.company_contact_id.name"/>.
                                </div>
                                <h3>Partner Information</h3>
                                <div name="partner_address">
                                    <address t-field="doc.partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;], &quot;no_marker&quot;: True}"/>
                                </div>
                                <div name="partner_contact">
                                    Represented by <span t-field="doc.partner_contact_id.name"/>.
                                </div>
                            </t>
                            
                            <!-- Sections & clauses -->
                            
                            <h2>Agreement</h2>
                            <h3>Recitals</h3>
                            <p t-foreach="doc.recital_ids" t-as="r">
                              <t t-if="r.title">
                                <h3 t-field="r.title"/>
                              </t>
                              <t t-if="r.dynamic_content">
                                <p t-field="r.dynamic_content"/>
                              </t>
                            </p>

                            <p t-foreach="doc.sections_ids" t-as="s">
                                <t t-if="s.title">
                                    <h3 t-field="s.title"/>
                                </t>
                                <t t-if="s.dynamic_content">
                                  <p t-field="s.dynamic_content"/>
                                </t>
                                <p t-foreach="s.clauses_ids" t-as="c">
                                    <t t-if="c.title">
                                      <h4 t-field="c.title"/>
                                    </t>
                                    <t t-if="c.dynamic_content">
                                      <p t-field="c.dynamic_content"/>
                                    </t>
                                </p>
                            </p>

                            <!-- Special terms -->
                            
                            <t t-if="doc.special_terms">
                                <h2>Special Terms</h2>
                                <div name="special_term">
                                    <p t-field="doc.dynamic_special_terms"/>
                                </div>
                            </t>

                            <!-- Signature tab -->
                            
                            <h2>Signatures</h2>
                            <table class="table table-condensed">
                                <thead>
                                    <tr>
                                        <th>Partner</th>
                                        <th>Company</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td width="50%">
                                            <p t-field="doc.partner_id"/>
                                            <p>By: </p>
                                            <p>
                                                Name: <span t-field="doc.partner_contact_id.name"/>
                                            </p>
                                            <p>
                                                Title: <span t-field="doc.partner_contact_id.function"/>
                                            </p>
                                            <p>Date: </p>
                                        </td>
                                        <td width="50%">
                                            <p t-field="doc.company_id.partner_id"/>
                                            <p>By: </p>
                                            <p>
                                                Name: <span t-field="doc.company_contact_id.name"/>
                                            </p>
                                            <p>
                                                Title: <span t-field="doc.company_contact_id.function"/>
                                            </p>
                                            <p>Date: </p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Products & services tab -->
                        
                        <div>
                          <t t-if="doc.line_ids">
                              <h1 style="page-break-before: always;">Products and services</h1>
                              <table class="table table-condensed">
                                <thead>
                                  <tr>
                                    <th>Name</th>
                                    <th>Description</th>
                                    <th>Quantity</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr t-foreach="doc.line_ids" t-as="p">
                                    <td scope="row"><strong><span t-field="p.product_id"/></strong></td>
                                    <td><span t-field="p.product_id.description_sale"/></td>
                                    <td><span t-field="p.qty"/> <span t-field="p.uom_id"/></td>
                                  </tr>
                                </tbody>
                              </table>
                            </t>
                        </div>
                        
                        <!-- Appendix -->
                        
                        <div t-foreach="doc.appendix_ids" t-as="a">
                            <div class="page">
                                <h1 t-field="a.title" style="page-break-before: always;"/>
                                <p t-field="a.dynamic_content"/>
                            </div>
                        </div>
                        
                    </t>
                </t>
            </t>
        </t>
    </template>

</odoo>
